CREATE DATABASE GRAPHIC_MASTER;
USE GRAPHIC_MASTER;

CREATE TABLE CLIENTE (
	ID_CLIENTE int(11) NOT NULL AUTO_INCREMENT,
	NOME_CLIENTE varchar(64) CHARACTER SET utf8 NOT NULL,
	CPF char(11) CHARACTER SET utf8 NOT NULL UNIQUE,
	PRIMARY KEY (ID_CLIENTE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE FORNECEDOR (
	ID_FORNECEDOR int(11) NOT NULL AUTO_INCREMENT,
	NOME_FORNECEDOR varchar(64) CHARACTER SET utf8 NOT NULL,
	CNPJ char(14) CHARACTER SET utf8 NOT NULL UNIQUE,
	PRIMARY KEY (ID_FORNECEDOR)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE MATERIA_PRIMA (
	ID_PRODUTO int(11) NOT NULL AUTO_INCREMENT,
	NOME_MP varchar(64) CHARACTER SET utf8 NOT NULL,
	VALIDADE date NOT NULL,
	UNIDADE varchar(10) CHARACTER SET utf8 NOT NULL,
	VALOR decimal(10, 2) NOT NULL,
	QTD_ESTOQUE int(11) NOT NULL,
	ID_FORNECEDOR int(11) NOT NULL,
	PRIMARY KEY (ID_PRODUTO),
	FOREIGN KEY (ID_FORNECEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE PERMISSAO (
	ID_PERMISSAO int(11) NOT NULL AUTO_INCREMENT,
	NOME_PERMISSAO varchar(64) CHARACTER SET utf8 NOT NULL UNIQUE,
	READ_CLIENTE tinyint(1) NOT NULL DEFAULT '0',
	INSERT_CLIENTE tinyint(1) NOT NULL DEFAULT '0',
	UPDATE_CLIENTE tinyint(1) NOT NULL DEFAULT '0',
	REMOVE_CLIENTE tinyint(1) NOT NULL DEFAULT '0',
	READ_FORNECEDOR tinyint(1) NOT NULL DEFAULT '0',
	INSERT_FORNECEDOR tinyint(1) NOT NULL DEFAULT '0',
	UPDATE_FORNECEDOR tinyint(1) NOT NULL DEFAULT '0',
	REMOVE_FORNECEDOR tinyint(1) NOT NULL DEFAULT '0',
	READ_MP tinyint(1) NOT NULL DEFAULT '1',
	INSERT_MP tinyint(1) NOT NULL DEFAULT '0',
	UPDATE_MP tinyint(1) NOT NULL DEFAULT '0',
	REMOVE_MP tinyint(1) NOT NULL DEFAULT '0',
	READ_PERMISSAO tinyint(1) NOT NULL DEFAULT '1',
	INSERT_PERMISSAO tinyint(1) NOT NULL DEFAULT '0',
	UPDATE_PERMISSAO tinyint(1) NOT NULL DEFAULT '0',
	REMOVE_PERMISSAO tinyint(1) NOT NULL DEFAULT '0',
	READ_USUARIO tinyint(1) NOT NULL DEFAULT '0',
	INSERT_USUARIO tinyint(1) NOT NULL DEFAULT '0',
	UPDATE_USUARIO tinyint(1) NOT NULL DEFAULT '0',
	REMOVE_USUARIO tinyint(1) NOT NULL DEFAULT '0',
	PRIMARY KEY (ID_PERMISSAO)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE USUARIO (
	ID_USUARIO int(11) NOT NULL AUTO_INCREMENT,
	NOME_USUARIO varchar(64) CHARACTER SET utf8 NOT NULL,
	LOGIN varchar(16) CHARACTER SET utf8 NOT NULL UNIQUE,
	SENHA varchar(255) CHARACTER SET utf8 NOT NULL,
	CARGO int(11) NOT NULL,
	PRIMARY KEY (ID_USUARIO),
	FOREIGN KEY (CARGO) REFERENCES PERMISSAO(ID_PERMISSAO)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE NOTA_FISCAL_CONSUMIDOR (
	ID_NOTA int(11) NOT NULL AUTO_INCREMENT,
	ID_CONSUMIDOR int(11) NOT NULL,
	VALOR decimal(10, 2) NOT NULL,
	PRIMARY KEY (ID_NOTA),
	FOREIGN KEY (ID_CONSUMIDOR) REFERENCES CLIENTE(ID_CLIENTE)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE NOTA_FISCAL_FORNECEDOR (
	ID_NOTA int(11) NOT NULL AUTO_INCREMENT,
	ID_VENDEDOR int(11) NOT NULL,
	VALOR decimal(10, 2) NOT NULL,
	PRIMARY KEY (ID_NOTA),
	FOREIGN KEY (ID_VENDEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE PRODUTOS_VENDIDOS (
	ID_NOTA int(11) NOT NULL,
	ID_CONSUMIDOR int(11) NOT NULL,
	ID_MP int(11) NOT NULL,
	QUANTIDADE int(11) NOT NULL,
	VALOR_UNITARIO decimal(10, 2) NOT NULL,
	FOREIGN KEY (ID_NOTA) REFERENCES NOTA_FISCAL_CONSUMIDOR(ID_NOTA),
	FOREIGN KEY (ID_CONSUMIDOR) REFERENCES CLIENTE(ID_CLIENTE),
	FOREIGN KEY (ID_MP) REFERENCES MATERIA_PRIMA(ID_PRODUTO)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

CREATE TABLE PRODUTOS_COMPRADOS (
	ID_NOTA int(11) NOT NULL,
	ID_VENDEDOR int(11) NOT NULL,
	ID_MP int(11) NOT NULL,
	QUANTIDADE int(11) NOT NULL,
	VALOR_UNITARIO decimal(10, 2) NOT NULL,
	FOREIGN KEY (ID_NOTA) REFERENCES NOTA_FISCAL_FORNECEDOR(ID_NOTA),
	FOREIGN KEY (ID_VENDEDOR) REFERENCES FORNECEDOR(ID_FORNECEDOR),
	FOREIGN KEY (ID_MP) REFERENCES MATERIA_PRIMA(ID_PRODUTO)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_general_ci;

INSERT INTO CLIENTE(ID_CLIENTE, NOME_CLIENTE, CPF) VALUES 
(1, 'NEYMAR DA SILVA SANTOS JÚNIOR', '38244335831'),
(2, 'ROMÁRIO DE SOUZA FARIA', '90671953753'),
(3, 'RONALDO DE ASSIS MOREIRA', '95673059000');

INSERT INTO FORNECEDOR(ID_FORNECEDOR, NOME_FORNECEDOR, CNPJ) VALUES 
(1, 'CHAMEX', '05455247000116'),
(2, 'BIC', '05726275000120'),
(3, 'FABER CASTELL', '59596908000152'),
(4, 'TILIBRA', '44990901000143'),
(5, 'XEROX', '02773629004006');

INSERT INTO MATERIA_PRIMA(ID_PRODUTO, NOME_MP, VALIDADE, UNIDADE, VALOR, QTD_ESTOQUE, ID_FORNECEDOR) VALUES
(1, 'PAPEL', '2020-01-10', 'KG', 100.00, 40, 1),
(2, 'CANETA', '2020-03-15', 'UN', 2.00, 15, 2),
(3, 'LÁPIS', '2020-05-25', 'UN', 1.00, 50, 3);

INSERT INTO PERMISSAO(ID_PERMISSAO, NOME_PERMISSAO, READ_CLIENTE, INSERT_CLIENTE, UPDATE_CLIENTE, REMOVE_CLIENTE, READ_FORNECEDOR, INSERT_FORNECEDOR, UPDATE_FORNECEDOR, REMOVE_FORNECEDOR, READ_MP, INSERT_MP, UPDATE_MP, REMOVE_MP, READ_PERMISSAO, INSERT_PERMISSAO, UPDATE_PERMISSAO, REMOVE_PERMISSAO, READ_USUARIO, INSERT_USUARIO, UPDATE_USUARIO, REMOVE_USUARIO) VALUES
(1, 'GERENTE', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
(2, 'ATENDENTE', 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0),
(3, 'PROJETISTA', 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0),
(4, 'ADMINISTRADOR', 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0);

INSERT INTO USUARIO(ID_USUARIO, NOME_USUARIO, LOGIN, SENHA, CARGO) VALUES
(1, 'LUIZ JOAQUIM ADERALDO AMICHI', 'luizjoaquim', '$2y$10$yf3ECHROfhHAXjZJ4e/zIOvn93z6/EVXMzqce3hZ88q2f6OvReBUW', 1),
(2, 'GUSTAVO BELANÇON MENDES', 'gustavo', '$2y$10$1PlnMx/kgDqRXPvFQuyAO.aPgUkJW2FNx1fCc2XdkkkE4rqRgEIQS', 2),
(3, 'FERNANDO SILVA SILVÉRIO', 'fernando', '$2y$10$7Vjw/8Fhks.zWB83PkQd8u5qVbdY.ptPGq.o1EigRSoWn2nBffHFa', 3),
(4, 'HÉCTOR DORRIGHELLO GIACON', 'hector', '$2y$10$TbG0NSYP9TPo318PcjnHTOhmXFznkRI7K0ZzFxjyJqdUmelpoVUba', 4);

INSERT INTO NOTA_FISCAL_CONSUMIDOR(ID_NOTA, ID_CONSUMIDOR, VALOR) VALUES
(1, 1, 202.00);

INSERT INTO NOTA_FISCAL_FORNECEDOR(ID_NOTA, ID_VENDEDOR, VALOR) VALUES
(1, 1, 4200.00),
(2, 2, 30.00),
(3, 3, 50.00);

INSERT INTO PRODUTOS_VENDIDOS(ID_NOTA, ID_CONSUMIDOR, ID_MP, QUANTIDADE, VALOR_UNITARIO) VALUES
(1, 1, 1, 2, 100.00),
(1, 1, 2, 1, 1.00);

INSERT INTO PRODUTOS_COMPRADOS(ID_NOTA, ID_VENDEDOR, ID_MP, QUANTIDADE, VALOR_UNITARIO) VALUES
(1, 1, 1, 42, 100.00),
(2, 2, 2, 16, 2.00),
(3, 3, 3, 50, 1.00);